<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="tr">
<head>
    <meta charset="UTF-8">
    <title>PLC Dashboard</title>

    <link rel="stylesheet" th:href="@{/css/dashboard.css(v=${#dates.createNow().time})}">
</head>
<body>

<div class="plc-header">

    <a th:href="@{/}" class="return-home-btn" title="Home">
        ‚Üê
    </a>

    <h1 class="plc-main-title">PLC Monitoring System</h1>

    <div class="plc-info-container">
        <div class="plc-id-section">
            <span class="plc-id-value" th:text="${plcId}">123</span>
        </div>

        <div class="plc-status-section">
            <div class="status-indicator"></div>
            <span class="plc-status" th:text="${plcStatus} ?: 'ACTIVE'">ACTIVE</span>
        </div>
    </div>
</div>

<div class="dashboard">
    <div th:each="lineText, iter : ${lineTexts}" class="line-column">
        <div class="line-header"
             th:classappend="${lineText.contains('running')} ? 'running' : (${lineText.contains('stopped')} ? 'stopped' : 'unknown')">
            <h3 style="margin:0; font-size: 0.9em;" th:text="${lineText}"></h3>
        </div>

        <div th:with="lineId=${iter.index + 1}">
            <div th:if="${groupedBarcodes.containsKey(lineId.toString())}">
                <div th:each="barcode : ${groupedBarcodes.get(lineId.toString())}" class="barcode-card">
                    <div class="barcode-number" th:text="${barcode.barcodeId.barcode}"></div>
                    <div class="barcode-image">
                        <svg th:attr="data-barcode=${barcode.barcodeId.barcode}"
                             class="barcode-svg"
                             width="150" height="40"
                             xmlns="http://www.w3.org/2000/svg"></svg>
                    </div>
                    <div class="barcode-info">
                        <strong>Status:</strong> <span class="status-error" th:text="${barcode.status}"></span><br>
                        <strong>Date:</strong>
                        <span th:text="${#temporals.format(barcode.lastStatusDate, 'dd.MM.yy HH:mm')}"></span>
                    </div>
                </div>
            </div>
            <div th:unless="${groupedBarcodes.containsKey(lineId.toString())}">
                <p class="no-barcodes">No barcodes</p>
            </div>
        </div>
    </div>
</div>

<script defer th:src="@{/js/dashboard.js(v=${#dates.createNow().time})}"></script>
</body>
</html>
